{"version":3,"sources":["trip-viewer-overlay.js"],"names":["TripViewerOverlay","nextProps","oldGeometry","props","tripData","geometry","newGeometry","pts","polyline","decode","points","leaflet","map","fitBounds","MapLayer","PropTypes","object","viewedTrip","mapStateToProps","state","ownProps","otp","ui","transitIndex","trips","tripId","mapDispatchToProps"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;IAEMA,iB;;;;;;;;;;;;;wCAMiB,CAAG,C,CAExB;;;;2CACwB,CAAG;;;8CAEAC,S,EAAW;AACpC,UAAMC,WAAW,GAAG,KAAKC,KAAL,CAAWC,QAAX,IAAuB,KAAKD,KAAL,CAAWC,QAAX,CAAoBC,QAA/D;AACA,UAAMC,WAAW,GAAGL,SAAS,CAACG,QAAV,IAAsBH,SAAS,CAACG,QAAV,CAAmBC,QAA7D;AACA,UAAIH,WAAW,KAAKI,WAAhB,IAA+B,CAACA,WAApC,EAAiD;;AACjD,UAAMC,GAAG,GAAGC,kBAASC,MAAT,CAAgBH,WAAW,CAACI,MAA5B,CAAZ;;AACA,WAAKP,KAAL,CAAWQ,OAAX,CAAmBC,GAAnB,CAAuBC,SAAvB,CAAiCN,GAAjC;AACD;;;2CAEuB,CAAG;;;2CAEH,CAAG;;;6BAEjB;AAAA,UACAH,QADA,GACa,KAAKD,KADlB,CACAC,QADA;AAGR,UAAI,CAACA,QAAD,IAAa,CAACA,QAAQ,CAACC,QAA3B,EAAqC,OAAO,6BAAC,0BAAD,OAAP;;AAErC,UAAME,GAAG,GAAGC,kBAASC,MAAT,CAAgBL,QAAQ,CAACC,QAAT,CAAkBK,MAAlC,CAAZ;;AACA,aACE,6BAAC,0BAAD,QACE,6BAAC,sBAAD;AAAU,QAAA,SAAS,EAAEH,GAArB;AAA0B,QAAA,MAAM,EAAE,CAAlC;AAAqC,QAAA,KAAK,EAAC,SAA3C;AAAqD,QAAA,OAAO,EAAE;AAA9D,QADF,CADF;AAKD;;;;EAlC6BO,sB,GAqChC;;;gBArCMd,iB,eACe;AACjBI,EAAAA,QAAQ,EAAEW,mBAAUC,MADH;AAEjBC,EAAAA,UAAU,EAAEF,mBAAUC;AAFL,C;;AAsCrB,IAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAQC,QAAR,EAAqB;AAC3C,MAAMH,UAAU,GAAGE,KAAK,CAACE,GAAN,CAAUC,EAAV,CAAaL,UAAhC;AACA,SAAO;AACLA,IAAAA,UAAU,EAAVA,UADK;AAELb,IAAAA,QAAQ,EAAEa,UAAU,GAChBE,KAAK,CAACE,GAAN,CAAUE,YAAV,CAAuBC,KAAvB,CAA6BP,UAAU,CAACQ,MAAxC,CADgB,GAEhB;AAJC,GAAP;AAMD,CARD;;AAUA,IAAMC,kBAAkB,GAAG,EAA3B;;eAGe,yBAAQR,eAAR,EAAyBQ,kBAAzB,EAA6C,+BAAY1B,iBAAZ,CAA7C,C","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { FeatureGroup, MapLayer, Polyline, withLeaflet } from 'react-leaflet'\n\nimport polyline from '@mapbox/polyline'\n\nclass TripViewerOverlay extends MapLayer {\n  static propTypes = {\n    tripData: PropTypes.object,\n    viewedTrip: PropTypes.object\n  }\n\n  componentDidMount () { }\n\n  // TODO: determine why the default MapLayer componentWillUnmount() method throws an error\n  componentWillUnmount () { }\n\n  componentWillReceiveProps (nextProps) {\n    const oldGeometry = this.props.tripData && this.props.tripData.geometry\n    const newGeometry = nextProps.tripData && nextProps.tripData.geometry\n    if (oldGeometry === newGeometry || !newGeometry) return\n    const pts = polyline.decode(newGeometry.points)\n    this.props.leaflet.map.fitBounds(pts)\n  }\n\n  createLeafletElement () { }\n\n  updateLeafletElement () { }\n\n  render () {\n    const { tripData } = this.props\n\n    if (!tripData || !tripData.geometry) return <FeatureGroup />\n\n    const pts = polyline.decode(tripData.geometry.points)\n    return (\n      <FeatureGroup>\n        <Polyline positions={pts} weight={8} color='#00bfff' opacity={0.6} />\n      </FeatureGroup>\n    )\n  }\n}\n\n// connect to the redux store\n\nconst mapStateToProps = (state, ownProps) => {\n  const viewedTrip = state.otp.ui.viewedTrip\n  return {\n    viewedTrip,\n    tripData: viewedTrip\n      ? state.otp.transitIndex.trips[viewedTrip.tripId]\n      : null\n  }\n}\n\nconst mapDispatchToProps = {\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withLeaflet(TripViewerOverlay))\n"]}